package statistique;

import java.io.IOException;


import com.itextpdf.io.font.FontConstants;
import com.itextpdf.kernel.font.PdfFont;
import com.itextpdf.kernel.font.PdfFontFactory;
import com.itextpdf.kernel.pdf.PdfDocument;
import com.itextpdf.kernel.pdf.PdfWriter;
import com.itextpdf.layout.Document;
import com.itextpdf.layout.element.IBlockElement;
import com.itextpdf.layout.element.List;
import com.itextpdf.layout.element.ListItem;
import com.itextpdf.layout.element.Paragraph;
import com.itextpdf.layout.element.Text;
import com.itextpdf.kernel.pdf.PdfName;
import statistique.Donnees;

/**
 * <b> Cette class permet de créer le squelette du pdf compte rendu de modélisation</b>
 * <p> Pour cela la libraire itext est necessaire. Il s'agit d'une librairie libre de droit dons vous trouverair les détails là: @see pom.xml.</p>
 * <p> Les variables nécéssaire à l'élaboration du pdf sont les suivantes:</p>
 * <ul>
 * <li> Le nom du fichier qui peremt de à l'utilisateur de nommer le fichier</li>
 * <li> la list de donne qui permetra dde remplir le fichier pdf avec les données de la modélisation</li>
 * </ul>
 * 
 * @author Mélodia
 * 
 *
 */




public class CreatePdf {  
	
	/**
	 * Permet de nommer le nom du fichier non modfiable.
	 */
	static String nomFichier;
	
	
	/**
	 * Donnees de la simulation
	 */
	
	static Donnees donneeSimul;
	

	
	/**
	 * Constructeur de la classe.
	 * 
	 * @param nomFichier
	 * 			Nom donné au fichier non modifiable.
	 * @param doneeSimul
	 * 			Données de la simulation non modifiable.
	 */
	public CreatePdf( String nomFichier, Donnees donneeSimul) {
		
		CreatePdf.nomFichier = nomFichier;
		CreatePdf.donneeSimul = donneeSimul;

	}
	

	/**
	 * Création du chemin ou le pdf sera enregistré.
	 */

	public static final String DEST = "compte_rendu/"+ nomFichier+".pdf";

	/**
	 * Cration du document via un main lors de la creation du doc tout est cré d'un coup.
	 * 
	 * @param args
	 * @throws IOException
	 */
	public static void main(String args[]) throws IOException {
		
		PdfDocument pdf = new PdfDocument(new PdfWriter(DEST));
		Document document = new Document(pdf);

		// Creation d'une font pour pdf
		PdfFont font = PdfFontFactory.createFont(FontConstants.TIMES_ROMAN);

		// écriture du contenue du PDF
		
		// écriture du contenu de cahque paragraphe

		String para1 = "Dans ce PDF vous trouverez les statistiques que nous avons pu ressortir de votre simulation. Les données qui ont servi à leur élaboration vous seront données en première partie.";  

		String para2 = "Voici les données jour par jour de la simulation:";
		
		String para3 = "Données génerales:";

		String para4 = "Pour les Carnivores:";
		
		String para5 = "Pour les Charognards:";
		
		String para6 = "Pour les Herbivores:";

		String para7 = "Nous observons les graphiques suivants:";

		String para8 = "Nous espérons que cette simulation a pu vous éclairer dans vos recherches.";   
		
		// création des paragraph via la methode paragraph de la class paragraph et rajout d'indentation avec setFirstLineIndent et aplication de la font crée en debut avec setFont     
		Paragraph paragraph1 = new Paragraph(para1).setFont(font).setFirstLineIndent(20);   // on précise la police
		Paragraph paragraph2 = new Paragraph(para2).setFirstLineIndent(20);
		Paragraph paragraph3 = new Paragraph(para3).setFirstLineIndent(40);
		Paragraph paragraph4 =  new Paragraph(para4).setFirstLineIndent(40);
		Paragraph paragraph5 = new Paragraph(para5).setFirstLineIndent(40);
		Paragraph paragraph6 = new Paragraph(para6).setFirstLineIndent(40);
		Paragraph paragraph7 = new Paragraph(para7).setFirstLineIndent(20);
		Paragraph paragraph8 = new Paragraph(para8).setFirstLineIndent(20);


		// création de listes de point:

		List listDonneSimulationGenerale = new List()
				.setSymbolIndent(12)// on précise l'indentatation
				.setListSymbol("\u2022")// on choisi le symbole à utiliser pour les points
				.setFont(font);// on précise la font qu'on utilise pour le text
		
		
		List listDonneSimulationCarnivore = new List()
				.setSymbolIndent(12)
				.setListSymbol("\u2022")
				.setFont(font);
		

		List listDonneSimulationCharognard =new List()
				.setSymbolIndent(12)
				.setListSymbol("\u2022")
				.setFont(font);
		
		
		
		List listDonneSimulationHerbivore =new List()
				.setSymbolIndent(12)
				.setListSymbol("\u2022")
				.setFont(font);

		
		
		// on ajoute dans la liste les points que l'on veut ecrire.
		
		listDonneSimulationGenerale.add(new ListItem("" + donneeSimul.tSimulation))
		.add(new ListItem(donneeSimul.causeFinSimulation))
		.add(new ListItem("Nombre d'espèces au debut de la simulation: " + donneeSimul.nbEspeceDebut))
		.add(new ListItem("Nombre d'individus au début de la simulation: " + donneeSimul.nbTotalIndivDebut))
		.add(new ListItem("Nombre d'espèces à la fin de la simulation: " + donneeSimul.nbEspeceFin))
		.add(new ListItem("Nombre d'individus à la fin de la simulation: " + donneeSimul.nbTotalIndiFin));
		


		listDonneSimulationCarnivore.add(new ListItem("Nombre total de carnivores sur toute la simulation: " + donneeSimul.nbIndividus[1]))
		.add(new ListItem("Nombre d'individus au début de la simulation: " + donneeSimul.nbIndividuDebut[1]))
		.add(new ListItem("Nombre d'individus à la fin de la simulation: " + donneeSimul.nbIndividuFin[1]))
		.add(new ListItem("Age moyen de la population à la fin de la simulation: " + donneeSimul.moyenAgeParEspece[1]))
		.add(new ListItem("Nombre de carnivores morts durant la simulation: " + donneeSimul.nbMort[1]))
		.add(new ListItem("Nombre moyen de carnivores morts par jour: " ))
		.add(new ListItem("Nombre moyen de naissances de carnivore par jour: " + donneeSimul.nbMoyenNaissance[1]))
		.add(new ListItem("Nombre de morts par vieillesse durant la simulation: " + donneeSimul.nbMortNorm[1]))
		.add(new ListItem("Nombre moyen de décès par vieillesse par jour: "))
		.add(new ListItem("Nombre moyen de décès dus à la faim: " + donneeSimul.nbMortFaim[1]))
		.add(new ListItem("Nombre moyen de décès dus à la Soif: " + donneeSimul.nbMortSoif[1]))
		.add(new ListItem("Nombre moyen de décès autres que vieillesse par jour: "))
		.add(new ListItem("Age moyen à la mort: " + donneeSimul.moyenAgeALaMort[1]));

		
		listDonneSimulationCharognard.add(new ListItem("Nombre total de charognards sur toute la simulation: "))
		.add(new ListItem("Nombre d'individus au début de la simulation: "))
		.add(new ListItem("Nombre d'individus à la fin de la simulation: "))
		.add(new ListItem("Nombre moyen de charognars mort par jour: "))
		.add(new ListItem("Nombre moyen de naissances de charognards par jour: "))
		.add(new ListItem("Nombre moyen de charognards en vie par jour: "))
		.add(new ListItem("Nombre moyen de décès par viellesse par jour: "))
		.add(new ListItem("Nombre moyen de décès autre que viellesse par jour: "))
		.add(new ListItem("Age moyen à la mort: "));

		
		
		listDonneSimulationHerbivore.add(new ListItem("Nombre total d'herbivores sur toute la simulation: "))
		.add(new ListItem("Nombre d'individus au début de la simulation: "))
		.add(new ListItem("Nombre d'individus à la fin de la simulation: "))
		.add(new ListItem("Nombre moyen d'herbivores morts par jour: "))
		.add(new ListItem("Nombre moyen de naissances d'herbivores par jour: "))
		.add(new ListItem("Nombre moyen d'herbivores en vie par jour: "))
		.add(new ListItem("Nombre moyen de décès par viellesse par jour: "))
		.add(new ListItem("Nombre moyen de décès autres que viellesse par jour: "))
		.add(new ListItem("Age moyen à la mort: "));
		

		// On ajoute les différentes partie cré precedement dans le pdf dans l'ordre soihaité.

		document.add(paragraph1)
		.add(paragraph2) 
		.add(paragraph3)
		.add(listDonneSimulationGenerale)
		.add(paragraph4)
		.add(listDonneSimulationCarnivore)
		.add(paragraph5)
		.add(listDonneSimulationCharognard)
		.add(paragraph6)
		.add(listDonneSimulationHerbivore)
		.add(paragraph7)
		.add(paragraph8);

		// on ferme le document. à noté que l'ouverture est automatique lors de sa création.
		document.close();
		
		// on prévient l'utilisatuer de la création du document et de son emplacement.
		System.out.println("Les données statistiques de cette modélisation sont disponibles dans le dossier compte_rendu de l'application. Le document est en format PDF et se nomme: "+ nomFichier);






	}



}




